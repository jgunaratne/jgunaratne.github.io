<link rel="import" href="../../../bower_components/polymer/polymer.html">
<polymer-element name="polymer-drive-breadcrumbs">
  <template>
    <link rel="stylesheet" href="polymer-drive-breadcrumbs.css">
    <ul>
      <template repeat="{{crumb, i in crumbs}}">
        <li class="label {{crumbs.length - 1 == i ? 'last' : ''}}"><polymer-drive-crumb crumb="{{crumb}}" index="{{i}}" lastcrumb="{{crumbs.length - 1 == i ? true : false}}"></polymer-drive-crumb></li>
        <polymer-ui-icon icon="dropdown"></polymer-ui-icon>
      </template>
    </ul>
  </template>
  <script>
  (function() {
    Polymer('polymer-drive-breadcrumbs', {
      crumbs: [],
      ready: function() {
        this.addCrumb(dataHandler.root);
      },
      initIncoming: function() {
        console.log("Initializing breadcrumbs for Incoming");
        this.crumbs = [];
        this.addCrumb(dataHandler.incoming);
      },
      initDrive: function() {
        console.log("Initializing breadcrumbs for Drive");
        this.crumbs = [];
        this.addCrumb(dataHandler.root);
      },
      addCrumb : function(item) {
        this.crumbs.push({
          title : item.title,
          item : item
        });
      }
    });
    })();
  </script>
</polymer-element>

<polymer-element name="polymer-drive-crumb" attributes="crumb index lastcrumb" on-click="onClick" on-mouseout="onMouseOut">
  <template>
  <style>
  :host {
    padding: 10px 10px;
    margin-left: -10px;
  }
  :host.over {
    background: #c6dcff;
    box-shadow: 0 0 2px 2px rgba(77,144,254,.4) inset;
  }
  polymer-ui-icon[icon=dropdown] {
    margin-left: 0;
  }
  .dropdown {
    background-image: url(../../../assets/img/arrow-down.svg);
    background-repeat: no-repeat;
    background-position: right center;
    padding-right: 24px;
  }
  </style>

  <template if="{{ lastcrumb == false}}">
    {{crumb.title}}
  </template>
  <template if="{{ lastcrumb == true}}">
    <polymer-drive-menu-button selected="0" icon="settings" label="{{crumb.title}}" halign="top" theme="polymer-ui-light-theme" class="noselection dropdown">
      <polymer-ui-menu-item icon="none" label="Open in"></polymer-ui-menu-item>
      <div class="menu-divider"></div>
      <polymer-ui-menu-item icon="account" label="Share..."></polymer-ui-menu-item>
      <polymer-ui-menu-item icon="down" label="Download"></polymer-ui-menu-item>
      <polymer-ui-menu-item icon="none" label="Rename..."></polymer-ui-menu-item>
      <div class="menu-divider"></div>
      <polymer-ui-menu-item icon="none" label="Move to..."></polymer-ui-menu-item>
      <polymer-ui-menu-item icon="none" label="Make a copy"></polymer-ui-menu-item>
      <polymer-ui-menu-item icon="none" label="Add star"></polymer-ui-menu-item>
      <polymer-ui-menu-item icon="none" label="Get info"></polymer-ui-menu-item>
      <div class="menu-divider"></div>
      <polymer-ui-menu-item icon="trash" label="Remove"></polymer-ui-menu-item>
    </polymer-drive-menu-button>
  </template>

  </template>
  <script>
  (function() {
    Polymer('polymer-drive-crumb', {
      read: function() {
      
      },
      removeCrumb : function(i) {
        var topHatBreadcrumbs = document.getElementsByTagName("polymer-drive-breadcrumbs")[0];
        topHatBreadcrumbs.crumbs.splice(this.index + 1, topHatBreadcrumbs.crumbs.length - this.index);
      },
      onMouseOut: function(e,i,el) {
        el.classList.remove('over');
      },
      onClick: function(e,i,el) {
        var topHatList = document.getElementsByTagName("polymer-drive-list")[0];
        topHatList.showFolder(this.crumb.item);
        this.removeCrumb(this.index);
        var toolbar = document.getElementsByTagName("polymer-drive-toolbar")[0];
        toolbar.name = this.crumb.title;
      }
    });
    })();
  </script>
</polymer-element>